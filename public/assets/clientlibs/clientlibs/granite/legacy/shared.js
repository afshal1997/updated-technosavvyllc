window._g=window._g||{},_g.shared={},void 0===window.console&&(window.console={log:function(e){}}),_g.shared.HTTP=new function(){var e=function(){var e=new Object;return e.headers=new Object,e.body=new Object,e},n=function(n){if(!n)return null;var t=e();return t.body=n.responseText,t.headers[_g.HTTP.HEADER_STATUS]=n.status,t.responseText=n.responseText,t.status=n.status,t};return{EXTENSION_HTML:".html",EXTENSION_JSON:".json",EXTENSION_RES:".res",HEADER_STATUS:"Status",HEADER_MESSAGE:"Message",HEADER_LOCATION:"Location",HEADER_PATH:"Path",PARAM_NO_CACHE:"cq_ck",get:function(e,t,r,i){if(e=_g.HTTP.getXhrHookedURL(_g.HTTP.externalize(e,!0)),null!=t)return _g.$.ajax({type:"GET",url:e,externalize:!1,encodePath:!1,hook:!1,complete:function(e,o){var a=n(e);i||_g.HTTP.handleForbidden(a),t.call(r||this,this,"success"==o,a)}});try{var o=_g.$.ajax({type:"GET",url:e,async:!1,externalize:!1,encodePath:!1,hook:!1}),a=n(o);return i||_g.HTTP.handleForbidden(a),a}catch(e){return null}},post:function(e,n,t,r,i,o){e=_g.HTTP.externalize(e,!0);var a=_g.HTTP.getXhrHook(e,"POST",t);if(a&&(e=a.url,t=a.params),null!=n)return _g.$.ajax({type:"POST",url:e,data:t,externalize:!1,encodePath:!1,hook:!1,complete:function(e,t){var i=_g.HTTP.buildPostResponseFromHTML(e.responseText);o||_g.HTTP.handleForbidden(e),n.call(r||this,this,"success"==t,i)}});try{var s=_g.$.ajax({type:"POST",url:e,data:t,async:!1,externalize:!1,encodePath:!1,hook:!1}),l=_g.HTTP.buildPostResponseFromHTML(s.responseText);return o||_g.HTTP.handleForbidden(s),l}catch(e){return null}},getParameter:function(e,n){var t=_g.HTTP.getParameters(e,n);return null!=t?t[0]:null},getParameters:function(e,n){var t=[];if(!n)return null;if(n=encodeURIComponent(n),-1==e.indexOf("?"))return null;-1!=e.indexOf("#")&&(e=e.substring(0,e.indexOf("#")));var r=e.substring(e.indexOf("?")+1);if(-1==r.indexOf(n))return null;for(var i=r.split("&"),o=0;o<i.length;o++){var a=i[o].split("=");a[0]==n&&t.push(a.length>1?decodeURIComponent(a[1]):"")}return t.length>0?t:null},addParameter:function(e,n,t){if(t&&t instanceof Array){for(var r=0;r<t.length;r++)e=_g.HTTP.addParameter(e,n,t[r]);return e}var i=-1==e.indexOf("?")?"?":"&",o=e.indexOf("#");if(o<0)return e+i+encodeURIComponent(n)+"="+encodeURIComponent(t);var a=e.substring(o);return(e=e.substring(0,o))+i+encodeURIComponent(n)+"="+encodeURIComponent(t)+a},setParameter:function(e,n,t){return e=_g.HTTP.removeParameter(e,n),_g.HTTP.addParameter(e,n,t)},removeParameter:function(e,n){var t,r="?"+encodeURIComponent(n)+"=",i="&"+encodeURIComponent(n)+"=";if(-1!=e.indexOf(r))t=r;else{if(-1==e.indexOf(i))return e;t=i}var o=e.indexOf(t),a=e.substring(0,o),s=e.indexOf("&",o+1),l="";return-1!=s&&0==(l=e.substring(s)).indexOf("&")&&(l=l.replace("&","?")),a+l},removeParameters:Granite.HTTP.removeParameters,addSelector:function(e,n,t){t||(t=0);var r="",i=e.indexOf("?");-1==i&&(i=e.indexOf("#")),-1!=i&&(r=e.substring(i),e=e.substring(0,i));var o=e.lastIndexOf("/"),a=e.substring(o);if(-1==a.indexOf("."+n+".")){var s=e.substring(0,o),l=a.split("."),g="",c="";(t>l.length-2||-1==t)&&(t=l.length-2);for(var d=0;d<l.length;d++)g+=c+l[d],c=".",t==d&&(g+=c+n);return s+g+r}return e},setSelector:function(e,n,t){var r="",i=e.indexOf("?");-1==i&&(i=e.indexOf("#")),-1!=i&&(r=e.substring(i),e=e.substring(0,i));var o=_g.HTTP.getSelectors(e),a=e.substring(e.lastIndexOf("."));e=e.substring(0,e.lastIndexOf("."));var s=o.length>0?e.replace("."+o.join("."),""):e;if(o.length>0)for(var l=0;l<o.length;l++)s+=t==l?"."+n:"."+o[l];else s+="."+n;return s+a+r},addSelectors:function(e,n){var t=e;if(e&&n&&n.length)for(var r=0;r<n.length;r++)t=_g.HTTP.addSelector(t,n[r],r);return t},getAnchor:function(e){return-1!=e.indexOf("#")?e.substring(e.indexOf("#")+1):""},setAnchor:function(e,n){return _g.HTTP.removeAnchor(e)+"#"+n},removeAnchor:Granite.HTTP.removeAnchor,noCaching:function(e){return _g.HTTP.setParameter(e,_g.HTTP.PARAM_NO_CACHE,(new Date).valueOf())},buildPostResponseFromNode:function(n,t){if(!n)return null;null==t&&(t=e());for(var r=0;r<n.childNodes.length;r++){var i=n.childNodes[r];i.tagName&&(i.id&&(i.href?t.headers[i.id]=i.href:t.headers[i.id]=i.innerHTML),t=_g.HTTP.buildPostResponseFromNode(i,t))}return t},buildPostResponseFromHTML:function(n){var t=e();try{null!=n.responseText?n=n.responseText:"string"!=typeof n&&(n=n.toString());var r=document.createElement("div");r.innerHTML=n,t=_g.HTTP.buildPostResponseFromNode(r,t),r=null}catch(e){}return t},getCookie:function(e){var n=encodeURIComponent(e)+"=",t=document.cookie;if(t.length>0){var r=t.indexOf(n);if(-1!=r){r+=n.length;var i=t.indexOf(";",r);return-1==i&&(i=t.length),decodeURIComponent(t.substring(r,i))}}return null},setCookie:function(e,n,t,r,i,o){var a;return"number"!=typeof r&&(r=7),r>0?(a=new Date).setTime(a.getTime()+24*r*60*60*1e3):a=new Date(0),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(n)+"; "+(0!=r?"expires="+a.toGMTString()+"; ":"")+(i?"domain="+i+"; ":"")+(t?"path="+t:"")+(o?"; secure":""),n},clearCookie:function(e,n,t,r){_g.HTTP.setCookie(e,"null",n||"",-1,t||"",r||"")},getSchemeAndAuthority:Granite.HTTP.getSchemeAndAuthority,getContextPath:Granite.HTTP.getContextPath,externalize:function(e,n){return"undefined"!=typeof G_IS_HOOKED&&G_IS_HOOKED(e)?e:(n&&(e=_g.HTTP.encodePathOfURI(e)),e=Granite.HTTP.externalize(e))},internalize:Granite.HTTP.internalize,getPath:Granite.HTTP.getPath,getSuffix:function(){return window.CQURLInfo&&CQURLInfo.suffix?CQURLInfo.suffix:null},getSelectors:function(e){if(!e&&window.CQURLInfo&&CQURLInfo.selectors)return CQURLInfo.selectors;var n=[];e=e||window.location.href,e=_g.HTTP.removeParameters(e);var t=(e=_g.HTTP.removeAnchor(e)).substring(e.lastIndexOf("/"));if(t){var r=t.split(".");if(r.length>2)for(var i=0;i<r.length;i++)i>0&&i<r.length-1&&n.push(r[i])}return n},getExtension:function(e){if(!e&&window.CQURLInfo&&CQURLInfo.extension)return CQURLInfo.extension;e=e||window.location.href,e=_g.HTTP.removeParameters(e);var n=(e=_g.HTTP.removeAnchor(e)).lastIndexOf(".");return n<0?"":(n=(e=e.substring(n+1)).indexOf("/"))<0?e:e.substring(0,n)},encodePathOfURI:Granite.HTTP.encodePathOfURI,encodePath:Granite.HTTP.encodePath,eval:Granite.HTTP.eval,isOkStatus:function(e){try{return 0==new String(e).indexOf("2")}catch(e){return!1}},isOk:function(e){try{return _g.HTTP.isOkStatus(e.headers[_g.HTTP.HEADER_STATUS])}catch(e){return!1}},handleForbidden:function(e,n){try{return 403==e[_g.HTTP.HEADER_STATUS.toLowerCase()]&&(Granite.HTTP.handleLoginRedirect(),!0)}catch(e){return!1}},getXhrHook:Granite.HTTP.getXhrHook,getXhrHookedURL:function(e,n,t){var r=_g.HTTP.getXhrHook(e,n,t);return r?r.url:e},reloadHook:function(e){return"undefined"!=typeof G_RELOAD_HOOK&&_g.$.isFunction(G_RELOAD_HOOK)&&(""!=CQURLInfo.selectorString&&(e=_g.HTTP.addSelector(e,CQURLInfo.selectorString)),e=G_RELOAD_HOOK(e)||e),e}}},_g.HTTP=_g.shared.HTTP,_g.shared.Util=new function(){return{reload:function(e,n,t){e||(e=window),n||(n=_g.HTTP.noCaching(e.location.href)),n=_g.HTTP.reloadHook(n),t?e.location.replace(n):e.location.href=n},load:function(e,n){_g.Util.reload(window,e,n)},open:function(e,n,t,r){if(n||(n=window),e)return e=_g.HTTP.reloadHook(e),t||(t=""),r||(r=""),n.open(e,t,r)},htmlEncode:function(e){return e?String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):e},htmlDecode:function(e){return e?String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):e},ellipsis:function(e,n,t){if(e&&e.length>n){if(t){var r=e.substr(0,n-2),i=Math.max(r.lastIndexOf(" "),r.lastIndexOf("."),r.lastIndexOf("!"),r.lastIndexOf("?"),r.lastIndexOf(";"));return-1==i||i<n-15?e.substr(0,n-3)+"...":r.substr(0,i)+"..."}return e.substr(0,n-3)+"..."}return e},patchText:Granite.Util.patchText,eval:function(e){return _g.HTTP.eval(e)},getTopWindow:Granite.Util.getTopWindow,setIFrameMode:Granite.Util.setIFrameMode}},_g.Util=_g.shared.Util,_g.shared.Sling={SELECTOR_INFINITY:Granite.Sling.SELECTOR_INFINITY,CHARSET:Granite.Sling.CHARSET,STATUS:Granite.Sling.STATUS,STATUS_BROWSER:Granite.Sling.STATUS_BROWSER,OPERATION:Granite.Sling.OPERATION,OPERATION_DELETE:Granite.Sling.OPERATION_DELETE,OPERATION_MOVE:Granite.Sling.OPERATION_MOVE,DELETE_SUFFIX:Granite.Sling.DELETE_SUFFIX,TYPEHINT_SUFFIX:Granite.Sling.TYPEHINT_SUFFIX,COPY_SUFFIX:Granite.Sling.COPY_SUFFIX,MOVE_SUFFIX:Granite.Sling.MOVE_SUFFIX,ORDER:Granite.Sling.ORDER,REPLACE:Granite.Sling.REPLACE,DESTINATION:Granite.Sling.DESTINATION,SAVE_PARAM_PREFIX:Granite.Sling.SAVE_PARAM_PREFIX,IGNORE_PARAM:Granite.Sling.IGNORE_PARAM,REQUEST_LOGIN_PARAM:Granite.Sling.REQUEST_LOGIN_PARAM,LOGIN_URL:Granite.Sling.LOGIN_URL,LOGOUT_URL:Granite.Sling.LOGOUT_URL,processBinaryData:function(e){if(e&&null!=e[":jcr:data"]){var n=new Object;n.size=e[":jcr:data"],n.type=e["jcr:mimeType"],n.date=e["jcr:lastModified"],e=n}return e},getContentPath:function(e,n,t){var r=n;if(r.lastIndexOf(".")>r.lastIndexOf("/")&&(r=r.substr(0,r.indexOf(".",r.lastIndexOf("/")))),e)if(0==e.indexOf("/"))r=e;else{if(t)for(;0==e.indexOf("../");)e=e.substring(3),r=r.substring(0,r.lastIndexOf("/"));r=r+"/"+(e=e.replace("./",""))}return r}},_g.Sling=_g.shared.Sling,_g.shared.XSS=new function(){return{getXSSPropertyName:function(e){return e?_g.XSS.KEY_REGEXP.test(e)?e:e+_g.XSS.KEY_SUFFIX:""},getXSSRecordPropertyValue:function(e,n,t){var r="";if(e&&n){var i=e.get(this.getXSSPropertyName(n));r=i||this.getXSSValue(e.get(n)),t&&!isNaN(t)&&(r=_g.Util.ellipsis(r,t,!0))}return r},getXSSTablePropertyValue:function(e,n,t){var r="";if(e&&n){var i=e[this.getXSSPropertyName(n)];r=i||this.getXSSValue(e[n]),t&&!isNaN(t)&&(r=_g.Util.ellipsis(r,t,!0))}return r},getXSSValue:function(e){return e?_g.Util.htmlEncode(e):""},updatePropertyName:function(e,n){e&&n&&e[n]&&e.xssProtect&&!e.xssKeepPropName&&(e[n]=this.getXSSPropertyName(e[n]))},xssPropertyRenderer:function(e,n,t,r){return r&&r.dataIndex&&t&&t.data&&t.data[this.getXSSPropertyName(r.dataIndex)]?(e=t.data[this.getXSSPropertyName(r.dataIndex)],r.ellipsisLimit&&!isNaN(r.ellipsisLimit)&&(e=_g.Util.ellipsis(e,r.ellipsisLimit,!0)),e):e||""}}},_g.XSS=_g.shared.XSS,_g.XSS.KEY_SUFFIX="_xss",_g.XSS.KEY_REGEXP=new RegExp(_g.XSS.KEY_SUFFIX+"$"),_g.shared.I18n=Granite.I18n,_g.I18n=_g.shared.I18n,_g.shared.I18n.getMessage=Granite.I18n.get,_g.shared.I18n.getVarMessage=Granite.I18n.getVar,_g.shared.String=new function(){return{startsWith:function(e,n){if(null==e||null==n)return null==e&&null==n;if(n.length>e.length)return!1;var t=e.toString(),r=n.toString();return 0==t.indexOf(r)},endsWith:function(e,n){return null==e||null==n?null==e&&null==n:!(n.length>e.length)&&(e=e.toString(),n=n.toString(),e.lastIndexOf(n)==e.length-n.length)},contains:function(e,n){return null!=e&&null!=n&&(e=e.toString(),n=n.toString(),e.indexOf(n)>=0)}}},_g.String=_g.shared.String,_g.shared.ClientSidePersistence=function(e){var n,t={PERSISTENCE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("ClientSidePersistence"),config:{},cache:null,getMode:function(){return this.config.mode},getWindow:function(){return this.config.window||_g.shared.Util.getTopWindow()},debug:function(){if(console){for(var e=this.getMap(),n="[ClientSidePersistence -> mode="+this.getMode().name+", container="+(this.config.container||"")+"]\n",t=0,r=new RegExp("^"+this.config.container+"/"),i=0,o=Object.keys(e).sort();i<o.length;i++){var a=o[i];if(!this.config.container||"string"!=typeof a||a.match(r)){var s=e[a];n+="-["+ ++t+"]-> '"+a.replace(r,"")+"' = '"+decodeURIComponent(s)+"'\n"}}t||(n+="(container is empty)"),console.log(n)}},keyName:function(e){return(this.config.container?this.config.container+"/":"")+e},getKeys:function(){var e=this.getMap(),n=[];if(e)for(var t in e)if(this.config.container){if(0==t.indexOf(this.config.container+"/")){var r=t.substring(this.config.container.length+1);n.push(r)}}else n.push(t);return n},get:function(e){var n=this.getMap()[this.keyName(e)];return n?decodeURIComponent(n):n},set:function(e,n){var t={key:e="string"==typeof e?e.replace(/:=/g,""):""};if((e=this.keyName(e)).length){var r=[],i=this.getMap();for(var o in t.action=i[e]?"update":"set",n?i[e]=encodeURIComponent(n):(t.action="remove",delete i[e]),i)r.push(o+":="+i[o]);this.cache=i,this.write(r.join("|")),_g.$.extend(t,{value:n,mode:this.getMode().name,container:this.config.container}),_g.$(_g.shared.ClientSidePersistence).trigger(_g.shared.ClientSidePersistence.EVENT_NAME,t)}},getMap:function(){if(!this.cache||!this.config.useCache){for(var e=this.read().split("|"),n={},t=0;t<e.length;t++){var r=e[t].split(":="),i=r[0];i&&i.length&&(n[i]=r[1]||"")}this.cache=n}return this.cache},remove:function(e){this.set(e)},clearMap:function(){this.write()},read:function(){return this.config.mode.read(this)||""},write:function(e){this.config.mode.write(this,e||"")}};_g.$.extend(t.config,_g.shared.ClientSidePersistence.getDefaultConfig(),e),!1===t.config.useContainer&&(t.config.container=null);var r="test-"+Math.random();if(t.config.mode===_g.shared.ClientSidePersistence.MODE_SESSION){n=!1;try{window.sessionStorage.setItem(r,r),window.sessionStorage.removeItem(r)}catch(e){n=!0}n&&(t.config.mode=_g.shared.ClientSidePersistence.MODE_LOCAL)}if(t.config.mode===_g.shared.ClientSidePersistence.MODE_LOCAL){n=!1;try{window.localStorage.setItem(r,r),window.localStorage.removeItem(r)}catch(e){n=!0}n&&(t.config.mode=_g.shared.ClientSidePersistence.MODE_WINDOW)}return t},_g.shared.ClientSidePersistence.EVENT_NAME="ClientSidePersistence",_g.shared.ClientSidePersistence.MODE_SESSION={name:"session",read:function(e){return e.getWindow().sessionStorage.getItem(e.PERSISTENCE_NAME)},write:function(e,n){if(!Granite.OptOutUtil.isOptedOut())try{e.getWindow().sessionStorage.setItem(e.PERSISTENCE_NAME,n)}catch(e){return}}},_g.shared.ClientSidePersistence.MODE_LOCAL={name:"local",read:function(e){return e.getWindow().localStorage.getItem(e.PERSISTENCE_NAME)},write:function(e,n){if(!Granite.OptOutUtil.isOptedOut())try{e.getWindow().localStorage.setItem(e.PERSISTENCE_NAME,n)}catch(e){return}}},_g.shared.ClientSidePersistence.decoratePersistenceName=function(e){return e},_g.shared.ClientSidePersistence.MODE_WINDOW={name:"window",read:function(e){return e.getWindow().name},write:function(e,n){Granite.OptOutUtil.isOptedOut()||(e.getWindow().name=n)}},_g.shared.ClientSidePersistence.MODE_COOKIE={COOKIE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("SessionPersistence"),name:"cookie",read:function(e){return _g.shared.ClientSidePersistence.CookieHelper.read(this.COOKIE_NAME)},write:function(e,n){Granite.OptOutUtil.isOptedOut()&&!Granite.OptOutUtil.maySetCookie(this.COOKIE_NAME)||(n?_g.shared.ClientSidePersistence.CookieHelper.set(this.COOKIE_NAME,n,365):_g.shared.ClientSidePersistence.CookieHelper.erase(this.COOKIE_NAME))}},_g.shared.ClientSidePersistence.getDefaultConfig=function(){return{window:_g.shared.Util.getTopWindow(),useCache:!1,container:null,mode:_g.shared.ClientSidePersistence.MODE_LOCAL}},_g.shared.ClientSidePersistence.CookieHelper={set:function(e,n,t){var r="";if(t){var i=new Date;i.setTime(i.getTime()+24*t*60*60*1e3),r="; expires="+i.toGMTString()}n&&(n=encodeURIComponent(n)),document.cookie=e+"="+n+r+"; path=/"},read:function(e){for(var n=e+"=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var i=t[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(n)){var o=i.substring(n.length,i.length);return o?decodeURIComponent(o):null}}return null},erase:function(e){_g.shared.ClientSidePersistence.CookieHelper.set(e,"",-1)}},_g.shared.ClientSidePersistence.clearAllMaps=function(){var e=[_g.shared.ClientSidePersistence.MODE_COOKIE,_g.shared.ClientSidePersistence.MODE_LOCAL,_g.shared.ClientSidePersistence.MODE_SESSION,_g.shared.ClientSidePersistence.MODE_WINDOW];_g.$.each(e,function(e,n){new _g.shared.ClientSidePersistence({mode:n}).clearMap()})},_g.I18n.init();